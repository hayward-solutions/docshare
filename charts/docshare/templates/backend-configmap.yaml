apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "docshare.fullname" . }}-backend
  labels:
    {{- include "docshare.labels" . | nindent 4 }}
    app.kubernetes.io/component: backend
data:
  DB_HOST: {{ include "docshare.postgresHost" . | quote }}
  DB_PORT: {{ include "docshare.postgresPort" . | quote }}
  DB_USER: {{ ternary .Values.postgresql.auth.username .Values.externalDatabase.user .Values.postgresql.enabled | quote }}
  DB_NAME: {{ ternary .Values.postgresql.auth.database .Values.externalDatabase.database .Values.postgresql.enabled | quote }}
  DB_SSLMODE: {{ ternary .Values.backend.env.dbSslmode .Values.externalDatabase.sslmode .Values.postgresql.enabled | quote }}
  S3_REGION: {{ .Values.s3.region | quote }}
  S3_ENDPOINT: {{ include "docshare.s3Endpoint" . | quote }}
  S3_PUBLIC_ENDPOINT: {{ .Values.s3.publicEndpoint | quote }}
  S3_BUCKET: {{ .Values.s3.bucket | quote }}
  S3_USE_SSL: {{ .Values.s3.useSsl | quote }}
  GOTENBERG_URL: {{ default (include "docshare.gotenbergUrl" .) .Values.backend.env.gotenbergUrl | quote }}
  SERVER_PORT: {{ .Values.backend.env.serverPort | quote }}
  JWT_EXPIRATION_HOURS: {{ .Values.backend.env.jwtExpirationHours | quote }}
